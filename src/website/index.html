<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proyecto Horticultura-Inicio</title>
    <style>
        .image_box {
            text-align: center;
        }

        .imagen {
            display: block;
            margin: 15px;
            width: 85%;
        }
    </style>
</head>

<body>
    <div class="image_box">
        <img src="/logo" class="imagen">
    </div>
    <div>
        <strong>Hora: </strong><span id="Hora_h"></span>:<span id="Hora_m"></span>
        <span><strong>Nombre de la Red:</strong> </span><span id="ID"></span>
        <span><strong>Contraseña de la Red:</strong> </span><span id="PASS"></span>
        <span><strong>Versión:</strong> </span><span id="Version"></span>
    </div>


    <h2>Potencia de luz</h2>
    <span><strong>Intensidad:</strong> </span><span id="PWM_Intensidad"></span>
    <br><br>
    <span><strong>Modo:</strong> </span><span id="PWM_modo"></span>
    <br><br>
    <span><strong>Encendido:</strong> </span><span id="PWM_horarioih"></span>:<span id="PWM_horarioim"></span>
    <br><br>
    <span><strong>Apagado:</strong> </span><span id="PWM_horariofh"></span>:<span id="PWM_horariofm"></span>
    <br><br>
    <span><strong>Amanecer / Atardecer:</strong> </span><span id="PWM_DIA"></span>
    <br><br>
    <h2>Control 220V</h2>
    <span><strong>Modo:</strong> </span><span id="TRIAC_modo"></span>
    <p id="h1e" style="display: none;">Horario 1 Habilitado</p>
    <p id="h1d" style="display: none;">Horario 1 Deshabilitado</p>
    <span><strong>Encendido:</strong> </span><span id="TRIAC_horarioi1_h"></span>:<span id="TRIAC_horarioi1_m"></span>
    <span><strong>Apagado:</strong> </span><span id="TRIAC_horariof1_h"></span>:<span id="TRIAC_horariof1_m"></span>
    <p id="h2e" style="display: none;">Horario 2 Habilitado</p>
    <p id="h2d" style="display: none;">Horario 2 Deshabilitado</p>
    <span><strong>Encendido:</strong> </span><span id="TRIAC_horarioi2_h"></span>:<span id="TRIAC_horarioi2_m"></span>
    <span><strong>Apagado:</strong> </span><span id="TRIAC_horariof2_h"></span>:<span id="TRIAC_horariof2_m"></span>
    <p id="h3e" style="display: none;">Horario 3 Habilitado</p>
    <p id="h3d" style="display: none;">Horario 3 Deshabilitado</p>
    <span><strong>Encendido:</strong> </span><span id="TRIAC_horarioi3_h"></span>:<span id="TRIAC_horarioi3_m"></span>
    <span><strong>Apagado:</strong> </span><span id="TRIAC_horariof3_h"></span>:<span id="TRIAC_horariof3_m"></span>
    <p id="h4e" style="display: none;">Horario 4 Habilitado</p>
    <p id="h4d" style="display: none;">Horario 4 Deshabilitado</p>
    <span><strong>Encendido:</strong> </span><span id="TRIAC_horarioi4_h"></span>:<span id="TRIAC_horarioi4_m"></span>
    <span><strong>Apagado:</strong> </span><span id="TRIAC_horariof4_h"></span>:<span id="TRIAC_horariof4_m"></span>
    <h2>Vegetacion/Floracion</h2>
    <span><strong>Modo:</strong> </span><span id="VEGEFLOR_modo"></span>
    <br><br>
    <button onclick="window.location.href ='/config'">
        Configuracion
    </button>
    <br><br>



    <script>
        function formatNumber(number) { //funcion para agregar un cero si es que el numero es menor a 10 para mostrarlo
            if (number >= 0 && number < 10) {
                return '0' + number;
            } else {
                return number;
            }
        }
        window.addEventListener('load', () => {
            setInterval(() => {
                fetch("/data_hora").then(res => {
                    if (!res.ok)
                        console.error("Error en adquirir los datos de la hora")
                    return res.json()
                }).then(data => {
                    console.log(data)
                    document.getElementById("Hora_h").textContent = formatNumber(data.Hora_h);
                    document.getElementById("Hora_m").textContent = formatNumber(data.Hora_m);
                })
                fetch("/data_pwm").then(res => {
                    if (!res.ok)
                        console.error("Error en adquirir los datos del pwm")
                    return res.json()
                }).then(data => {
                    console.log(data)
                    document.getElementById("PWM_Intensidad").textContent = data.intensidad;
                    document.getElementById("PWM_modo").textContent = data.Modo;
                    document.getElementById("PWM_horarioih").textContent = formatNumber(data.ih1h);
                    document.getElementById("PWM_horarioim").textContent = formatNumber(data.ih1m);
                    document.getElementById("PWM_horariofh").textContent = formatNumber(data.fh1h);
                    document.getElementById("PWM_horariofm").textContent = formatNumber(data.fh1m);
                    document.getElementById("PWM_DIA").textContent = data.DIA;
                })
                fetch("/data_triac").then(res => {
                    if (!res.ok)
                        console.error("Error en adquirir los datos del triac")
                    return res.json()
                }).then(data => {
                    console.log(data)
                    document.getElementById("TRIAC_modo").textContent = data.Modo;
                    if (data.cb1 == true) {
                        document.getElementById('h1e').style.display = 'block'
                    }
                    else {
                        document.getElementById('h1d').style.display = 'block'
                    }
                    if (data.cb2 == true) {
                        document.getElementById('h2e').style.display = 'block'
                    }
                    else {
                        document.getElementById('h2d').style.display = 'block'
                    }
                    if (data.cb3 == true) {
                        document.getElementById('h3e').style.display = 'block'
                    }
                    else {
                        document.getElementById('h3d').style.display = 'block'
                    }
                    if (data.cb4 == true) {
                        document.getElementById('h4e').style.display = 'block'
                    }
                    else {
                        document.getElementById('h4d').style.display = 'block'
                    }
                    document.getElementById("TRIAC_horarioi1_h").textContent = formatNumber(data.ih1h);
                    document.getElementById("TRIAC_horarioi1_m").textContent = formatNumber(data.ih1m);
                    document.getElementById("TRIAC_horariof1_h").textContent = formatNumber(data.fh1h);
                    document.getElementById("TRIAC_horariof1_m").textContent = formatNumber(data.fh1m);
                    document.getElementById("TRIAC_horarioi2_h").textContent = formatNumber(data.ih2h);
                    document.getElementById("TRIAC_horarioi2_m").textContent = formatNumber(data.ih2m);
                    document.getElementById("TRIAC_horariof2_h").textContent = formatNumber(data.fh2h);
                    document.getElementById("TRIAC_horariof2_m").textContent = formatNumber(data.fh2m);
                    document.getElementById("TRIAC_horarioi3_h").textContent = formatNumber(data.ih3h);
                    document.getElementById("TRIAC_horarioi3_m").textContent = formatNumber(data.ih3m);
                    document.getElementById("TRIAC_horariof3_h").textContent = formatNumber(data.fh3h);
                    document.getElementById("TRIAC_horariof3_m").textContent = formatNumber(data.fh3m);
                    document.getElementById("TRIAC_horarioi4_h").textContent = formatNumber(data.ih4h);
                    document.getElementById("TRIAC_horarioi4_m").textContent = formatNumber(data.ih4m);
                    document.getElementById("TRIAC_horariof4_h").textContent = formatNumber(data.fh4h);
                    document.getElementById("TRIAC_horariof4_m").textContent = formatNumber(data.fh4m);
                })
                fetch("/data_red").then(res => {
                    if (!res.ok)
                        console.error("Error en adquirir los datos de red")
                    return res.json()
                }).then(data => {
                    console.log(data);
                    document.getElementById("ID").textContent = data.ID;
                    document.getElementById("PASS").textContent = data.PASS;

                })
                fetch("/data_vegeflor").then(res => {
                    if (!res.ok)
                        console.error("Error en adquirir los datos de vegeflor")
                    return res.json()
                }).then(data => {
                    console.log(data)
                    document.getElementById("VEGEFLOR_modo").textContent = data.Modo;
                })
            }, 2000)

            fetch("/version").then(res => {
                if (!res.ok)
                    console.error("Error en adquirir los datos de version")
                return res.json()
            }).then(data => {
                console.log(data)
                document.getElementById("Version").textContent = data.Version;
            })
        })

    </script>
</body>

</html>